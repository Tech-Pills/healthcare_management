<div id="<%= dom_id medical_record %>">
  <div>
    <strong>Patient:</strong>
    <%= medical_record.patient&.full_name || "Unknown" %>
  </div>

  <div>
    <strong>Appointment:</strong>
    <%= medical_record.appointment_id %>
  </div>

  <div>
    <strong>Recorded at:</strong>
    <%= medical_record.recorded_at&.strftime("%B %d, %Y at %I:%M %p") %>
  </div>

  <% if medical_record.weight.present? %>
    <div>
      <strong>Weight:</strong>
      <%= medical_record.weight %> kg
    </div>
  <% end %>

  <% if medical_record.height.present? %>
    <div>
      <strong>Height:</strong>
      <%= medical_record.height %> cm
    </div>
  <% end %>

  <% if medical_record.heart_rate.present? %>
    <div>
      <strong>Heart Rate:</strong>
      <%= medical_record.heart_rate %> bpm
    </div>
  <% end %>

  <% if medical_record.temperature.present? %>
    <div>
      <strong>Temperature:</strong>
      <%= medical_record.temperature %>Â°C
    </div>
  <% end %>

  <% if medical_record.blood_pressure %>
    <div>
      <strong>Blood Pressure:</strong>
      <%= medical_record.blood_pressure %> mmHg
    </div>
  <% end %>

  <% if medical_record.diagnosis.present? %>
    <div>
      <strong>Diagnosis:</strong>
      <%= simple_format medical_record.diagnosis %>
    </div>
  <% end %>

  <% if medical_record.medications.present? %>
    <div>
      <strong>Medications:</strong>
      <%= simple_format medical_record.medications %>
    </div>
  <% end %>

  <% if medical_record.allergies.present? %>
    <div>
      <strong>Allergies:</strong>
      <%= simple_format medical_record.allergies %>
    </div>
  <% end %>

  <% if medical_record.notes.present? %>
    <div>
      <strong>Notes:</strong>
      <%= simple_format medical_record.notes %>
    </div>
  <% end %>

  <hr style="margin: 20px 0; border: 1px solid #ccc;">

  <h3>Medical Files</h3>

  <% if medical_record.x_ray_image.attached? %>
    <div style="margin: 15px 0;">
      <strong>X-ray Image:</strong>
      <div style="margin-top: 10px;">
        <%= image_tag medical_record.x_ray_image.variant(resize_to_limit: [ 600, 600 ]), style: "border: 2px solid #ddd; border-radius: 4px;" %>
      </div>
      <p style="margin-top: 10px; color: #666;">
        <%= medical_record.x_ray_image.filename %>
        (<%= number_to_human_size(medical_record.x_ray_image.byte_size) %>)
        -
        <%= link_to "Download Full Size", rails_blob_path(medical_record.x_ray_image, disposition: "attachment") %>
      </p>
    </div>
  <% else %>
    <p style="color: #999;">No X-ray image attached</p>
  <% end %>

  <% if medical_record.lab_results.attached? %>
    <div style="margin: 15px 0;">
      <strong>Lab Results:</strong>
      <ul style="margin-top: 10px; padding-left: 20px;">
        <% medical_record.lab_results.each do |lab_result| %>
          <li>
            <%= link_to lab_result.filename, rails_blob_path(lab_result, disposition: "inline"), target: "_blank" %>
            (<%= number_to_human_size(lab_result.byte_size) %>)
            -
            <%= link_to "Download", rails_blob_path(lab_result, disposition: "attachment") %>
          </li>
        <% end %>
      </ul>
    </div>
  <% else %>
    <p style="color: #999;">No lab results attached</p>
  <% end %>

</div>
